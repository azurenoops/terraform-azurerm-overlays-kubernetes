<<<<<<< HEAD
# Copyright (c) Microsoft Corporation.
# Licensed under the MIT License.

resource "azurerm_role_assignment" "network_contributor" {
  scope                            = local.resource_group_name
  role_definition_name             = "Network Contributor"
  principal_id                     = azurerm_user_assigned_identity.aks.0.principal_id
  skip_service_principal_aad_check = true
}

resource "azurerm_role_assignment" "aks_acr_pull_allowed" {
  for_each = toset(var.acr_pull_access)

  principal_id         = azurerm_user_assigned_identity.aks.0.principal_id
  scope                = each.value
  role_definition_name = "AcrPull"
=======
resource "azurerm_role_assignment" "network_contributor" {
  scope                = local.resource_group_name
  role_definition_name = "Network Contributor"
  principal_id         = module.aks_cluster.aks_identity_name.identity_object_id
  skip_service_principal_aad_check = true
}

resource "azurerm_role_assignment" "acr_pull" {
  role_definition_name = "AcrPull"
  scope                = module.container_registry.id
  principal_id         = module.aks_cluster.kubelet_identity_object_id
  skip_service_principal_aad_check = true
>>>>>>> f86e8078fb190ed2e7b3c954c286a25e72bfab98
}
